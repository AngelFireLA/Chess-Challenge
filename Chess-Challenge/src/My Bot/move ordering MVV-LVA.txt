Here's the full updated script:

```csharp
using System;
using ChessChallenge.API;

public class MyBot : IChessBot
{
    private Move emergencyMove;
    private bool isEmergencyMode;

    int[] p = new[] { 0, 1, 3, 3, 5, 9, 1000 }; // Piece values: None, Pawn, Knight, Bishop, Rook, Queen, King

    public Move Think(Board board, Timer timer) {
        
        if(timer.MillisecondsRemaining < 3000) {
            isEmergencyMode = true;
            emergencyMove = board.GetLegalMoves()[new Random().Next(board.GetLegalMoves().Length)];
            return emergencyMove;
        }

        AlphaBeta(board, 4, int.MinValue, int.MaxValue, board.IsWhiteToMove);
        return emergencyMove;
    }

    int AlphaBeta(Board board, int depth, int a, int b, bool white) {
        if (depth == 0)
            return MaterialScore(board, white);


        var m = board.GetLegalMoves();
        Array.Sort(m, (moveA, moveB) => GetMoveValue(moveB).CompareTo(GetMoveValue(moveA))); // Sorting moves in descending order

        for(int i = 0; i < m.Length; i++) {
            board.MakeMove(m[i]);
            var val = -AlphaBeta(board, depth - 1, -b, -a, !white);
            board.UndoMove(m[i]);

            if(val >= b)
                return b;

            if(val > a) {
                a = val;
                if (depth == 4){
                    emergencyMove = m[i];}
            }
            }    
        }

        return a;
    }

    int GetMoveValue(Move move)
    {
       return p[(int)move.CapturePieceType] - p[(int)move.MovePieceType]; // MVV-LVA
    }

    int MaterialScore(Board board, bool white) {
        int s = 0;
        var pieceLists = board.GetAllPieceLists();
        for(int i=0; i<pieceLists.Length; i++) {
            var pl = pieceLists[i];
            s += pl.Count * (pl.IsWhitePieceList == white ? 1 : -1) * p[(int)pl.TypeOfPieceInList];
        }  
        return s;
    }
}
```

This bot selects moves based on:
1. MVV-LVA move ordering to prioritize high value captures and low value threats.
2. Basic evaluation based on material balance.
3. Alpha-beta pruning to improve search efficiency.
4. It includes an emergency mode that returns a random move if remaining time is less than 3 seconds.